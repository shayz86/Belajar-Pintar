<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calistung Master - Belajar & Bermain</title>
    <!-- Tailwind CSS untuk styling cepat -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font ramah anak: Fredoka -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS Kustom Tambahan */
        body {
            font-family: 'Fredoka', sans-serif;
            background: #e0f2fe; /* Biru Muda lembut */
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent; /* Hilangkan highlight tap di mobile */
            user-select: none; /* Mencegah seleksi teks */
        }

        /* Gaya Tombol 3D 'Empuk' */
        .btn-3d {
            transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            top: 0;
            box-shadow: 0 6px 0 rgba(0,0,0,0.15); /* Bayangan bawah */
        }
        .btn-3d:active {
            top: 4px; /* Efek ditekan */
            box-shadow: 0 2px 0 rgba(0,0,0,0.15);
        }

        /* Animasi Melayang (Floating) */
        .floating { animation: float 3s ease-in-out infinite; }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        /* Animasi Muncul (Pop In) */
        .pop-in { animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Animasi Salah (Shake) */
        .shake { animation: shake 0.5s; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Manajemen Layar */
        .screen { display: none; min-height: 100vh; width: 100%; }
        .screen.active { display: flex; flex-direction: column; }
        
        /* Tampilan Suku Kata */
        .syllable-part {
            display: inline-block;
            padding: 0 5px;
            margin: 0 2px;
            border-bottom: 4px solid #cbd5e1;
        }
    </style>
</head>
<body class="bg-blue-50">

    <!-- 1. HALAMAN BERANDA -->
    <section id="home" class="screen active items-center justify-center p-6 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]">
        <div class="text-center mb-8 pop-in">
            <div class="text-8xl mb-4 floating">üöÄ</div>
            <h1 class="text-5xl font-bold text-blue-600 mb-2 drop-shadow-sm">CALISTUNG</h1>
            <h2 class="text-2xl font-semibold text-blue-400 bg-white inline-block px-4 py-1 rounded-full shadow-sm">Master Membaca</h2>
        </div>
        
        <div class="grid grid-cols-1 gap-4 w-full max-w-sm">
            <button onclick="nav('alphabet')" class="btn-3d w-full bg-yellow-400 hover:bg-yellow-300 text-white p-5 rounded-3xl text-xl font-bold flex items-center justify-between px-6 border-b-4 border-yellow-500">
                <span class="text-3xl">üÖ∞Ô∏è</span> <span>KENAL HURUF</span> <span>‚ûî</span>
            </button>
            
            <button onclick="nav('syllable-select')" class="btn-3d w-full bg-green-500 hover:bg-green-400 text-white p-5 rounded-3xl text-xl font-bold flex items-center justify-between px-6 border-b-4 border-green-600">
                <span class="text-3xl">üß©</span> <span>SUKU KATA</span> <span>‚ûî</span>
            </button>
            
            <button onclick="nav('reading-intro')" class="btn-3d w-full bg-pink-500 hover:bg-pink-400 text-white p-5 rounded-3xl text-xl font-bold flex items-center justify-between px-6 border-b-4 border-pink-600">
                <span class="text-3xl">üìñ</span> <span>BACA KATA</span> <span>‚ûî</span>
            </button>
            
            <button onclick="startGameMode()" class="btn-3d w-full bg-purple-600 hover:bg-purple-500 text-white p-5 rounded-3xl text-xl font-bold flex items-center justify-between px-6 border-b-4 border-purple-800 mt-4 relative overflow-hidden group">
                <div class="absolute inset-0 bg-white opacity-10 group-hover:opacity-20 transition"></div>
                <span class="text-3xl">üéÆ</span> <span>MINI GAME</span> <span>‚ûî</span>
            </button>
        </div>
    </section>

    <!-- 2. HALAMAN KENAL HURUF -->
    <section id="alphabet" class="screen p-4 bg-yellow-50">
        <div class="sticky top-0 z-20 flex items-center justify-between bg-yellow-50/95 backdrop-blur py-3 mb-4 border-b border-yellow-100">
            <button onclick="nav('home')" class="bg-white p-3 rounded-xl shadow text-xl active:scale-95">üè†</button>
            <h2 class="text-2xl font-bold text-yellow-600">Alfabet A-Z</h2>
            <div class="w-10"></div>
        </div>
        <div id="grid-alphabet" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 pb-20 max-w-4xl mx-auto">
            <!-- Diisi oleh JavaScript -->
        </div>
    </section>

    <!-- 3. HALAMAN PILIH SUKU KATA -->
    <section id="syllable-select" class="screen p-4 bg-green-50">
        <div class="sticky top-0 z-20 flex items-center justify-between bg-green-50/95 backdrop-blur py-3 mb-4 border-b border-green-100">
            <button onclick="nav('home')" class="bg-white p-3 rounded-xl shadow text-xl active:scale-95">üè†</button>
            <h2 class="text-2xl font-bold text-green-600">Pilih Huruf</h2>
            <div class="w-10"></div>
        </div>
        <div id="grid-syllable-letters" class="grid grid-cols-4 sm:grid-cols-5 gap-3 pb-20 max-w-3xl mx-auto">
            <!-- Diisi oleh JavaScript -->
        </div>
    </section>

    <!-- 4. HALAMAN MAIN SUKU KATA -->
    <section id="syllable-play" class="screen items-center justify-center p-6 bg-green-100">
        <div class="w-full max-w-md bg-white rounded-[40px] p-8 text-center shadow-2xl relative pop-in border-4 border-green-200">
            <button onclick="nav('syllable-select')" class="absolute top-4 left-4 text-gray-400 hover:text-gray-600 text-2xl">‚úñ</button>
            <div class="mb-2 text-sm font-bold text-green-400 tracking-widest mt-4">LATIHAN SUKU KATA</div>
            <div id="syl-icon" class="text-9xl mb-6 floating block mt-4">üçé</div>
            <div id="syl-text" class="flex justify-center gap-2 text-5xl font-bold text-gray-700 mb-8 uppercase flex-wrap"></div>
            <div class="space-y-4">
                <button onclick="speakSyllable()" class="w-full bg-blue-100 text-blue-600 font-bold py-4 rounded-2xl flex items-center justify-center gap-2 hover:bg-blue-200 transition text-xl">üîä Dengar</button>
                <button onclick="nextSyllable()" class="btn-3d w-full bg-green-500 text-white font-bold py-4 rounded-2xl text-2xl shadow-green-700/50">Lanjut ‚ûî</button>
            </div>
            <div class="mt-6 flex justify-center gap-2" id="syl-dots"></div>
        </div>
    </section>

    <!-- 5. HALAMAN BACA KATA (INTRO) -->
    <section id="reading-intro" class="screen items-center justify-center p-6 bg-pink-100">
        <div class="text-center max-w-md pop-in">
            <div class="text-8xl mb-4">üßê</div>
            <h2 class="text-4xl font-bold text-pink-600 mb-4">Fokus Baca Tulisan</h2>
            <p class="text-lg text-gray-600 mb-8">Disini tidak ada gambar. Kamu harus membaca tulisannya sendiri ya!</p>
            <button onclick="startReadingMode()" class="btn-3d bg-pink-500 text-white px-10 py-4 rounded-full text-2xl font-bold shadow-pink-700/50">Mulai Baca</button>
            <button onclick="nav('home')" class="block mt-6 text-gray-500 font-bold underline">Kembali</button>
        </div>
    </section>

    <!-- 6. HALAMAN BACA KATA (MAIN) -->
    <section id="reading-play" class="screen items-center justify-center p-6 bg-white relative">
        <button onclick="nav('reading-intro')" class="absolute top-6 left-6 p-3 bg-gray-100 rounded-2xl text-gray-500 hover:bg-gray-200 font-bold shadow-md z-10 flex items-center gap-2">
            <span>‚úñ</span> <span class="hidden sm:inline">Keluar</span>
        </button>

        <div class="w-full max-w-2xl text-center mt-10">
            <div class="mb-4 text-gray-400 font-bold uppercase tracking-widest">Tantangan Membaca</div>
            <div id="read-word" class="text-7xl sm:text-9xl font-black text-gray-800 tracking-wider mb-16 uppercase transition-all duration-300 transform">BOLA</div>
            
            <div class="grid gap-4 max-w-sm mx-auto">
                <button onclick="checkRead()" class="btn-3d bg-pink-500 text-white py-6 rounded-3xl font-bold text-2xl shadow-pink-700/50">AKU BISA BACA! ‚úîÔ∏è</button>
                <button onclick="speakReadWord()" class="text-pink-400 font-bold text-sm bg-pink-50 py-2 rounded-xl">üîä Bantuan Suara</button>
            </div>
            <div class="mt-12 flex justify-center gap-2" id="read-dots"></div>
        </div>
    </section>

    <!-- 7. HALAMAN MINI GAME (50 SOAL BANK) -->
    <section id="game-play" class="screen items-center justify-center p-4 bg-purple-600">
        <div class="w-full max-w-md bg-white rounded-[30px] p-6 shadow-2xl relative pop-in">
            <div class="flex justify-between items-center mb-6 bg-purple-50 p-3 rounded-2xl">
                <button onclick="nav('home')" class="text-purple-400 font-bold text-sm">‚úñ Keluar</button>
                <div class="text-right">
                    <div class="font-bold text-purple-800">Skor: <span id="game-score">0</span></div>
                    <div class="text-xs text-purple-400 font-bold mt-1">Soal <span id="game-progress">1</span>/10</div>
                </div>
            </div>

            <div class="text-center mb-8">
                <h3 class="text-gray-500 font-bold text-sm mb-2">Tebak Kata untuk gambar ini:</h3>
                <div id="game-question-icon" class="text-9xl floating inline-block">ü¶Å</div>
            </div>

            <div id="game-options" class="grid gap-3"></div>
            <div id="game-feedback" class="h-8 mt-4 text-center font-bold text-transparent">...</div>
        </div>
    </section>

    <!-- OVERLAY CONGRATS (Menang) -->
    <div id="overlay-congrats" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white p-8 rounded-[40px] text-center max-w-sm mx-4 pop-in border-8 border-yellow-400">
            <div class="text-8xl mb-4 animate-bounce">üèÜ</div>
            <h2 class="text-4xl font-bold text-yellow-500 mb-2">HEBAT!</h2>
            <p id="congrats-msg" class="text-gray-500 font-bold text-lg mb-8">Kamu menyelesaikan sesi ini!</p>
            <button onclick="closeCongrats()" class="btn-3d bg-blue-500 text-white py-4 px-10 rounded-full font-bold text-xl w-full">Main Lagi</button>
        </div>
    </div>

    <script>
        /* ================= DATA BANK ================= */
        const alphabetData = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('').map(char => {
            const examples = {
                'A':['Ayam','üêî'], 'B':['Bola','‚öΩ'], 'C':['Ceri','üçí'], 'D':['Dadu','üé≤'],
                'E':['Es','üßä'], 'F':['Foto','üì∑'], 'G':['Gajah','üêò'], 'H':['Hiu','ü¶à'],
                'I':['Ikan','üêü'], 'J':['Jus','ü•§'], 'K':['Kuda','üêé'], 'L':['Lemon','üçã'],
                'M':['Mobil','üöó'], 'N':['Nanas','üçç'], 'O':['Obor','üî•'], 'P':['Panda','üêº'],
                'Q':['Quran','üìñ'], 'R':['Roti','üçû'], 'S':['Sapi','üêÑ'], 'T':['Topi','üß¢'],
                'U':['Ular','üêç'], 'V':['Vas','üè∫'], 'W':['Wortel','ü•ï'], 'X':['Xilofon','üéπ'],
                'Y':['Yoyo','ü™Ä'], 'Z':['Zebra','ü¶ì']
            };
            return { char, word: examples[char][0], icon: examples[char][1] };
        });

        // BANK 50 SOAL MINI GAME
        const miniGameBank = [
            {w:"AYAM", i:"üêî"}, {w:"BOLA", i:"‚öΩ"}, {w:"KUCING", i:"üê±"}, {w:"IKAN", i:"üêü"}, {w:"GAJAH", i:"üêò"},
            {w:"RUMAH", i:"üè†"}, {w:"MOBIL", i:"üöó"}, {w:"BUKU", i:"üìö"}, {w:"PENSIL", i:"‚úèÔ∏è"}, {w:"POHON", i:"üå≥"},
            {w:"BUNGA", i:"üåª"}, {w:"MATAHARI", i:"‚òÄÔ∏è"}, {w:"BULAN", i:"üåô"}, {w:"BINTANG", i:"‚≠ê"}, {w:"PELANGI", i:"üåà"},
            {w:"API", i:"üî•"}, {w:"AIR", i:"üíß"}, {w:"ES", i:"üßä"}, {w:"ROTI", i:"üçû"}, {w:"SUSU", i:"ü•õ"},
            {w:"KEJU", i:"üßÄ"}, {w:"TELUR", i:"ü•ö"}, {w:"PIZZA", i:"üçï"}, {w:"BURGER", i:"üçî"}, {w:"DONAT", i:"üç©"},
            {w:"APEL", i:"üçé"}, {w:"PISANG", i:"üçå"}, {w:"ANGGUR", i:"üçá"}, {w:"JERUK", i:"üçä"}, {w:"NANAS", i:"üçç"},
            {w:"TOPI", i:"üß¢"}, {w:"BAJU", i:"üëï"}, {w:"CELANA", i:"üëñ"}, {w:"SEPATU", i:"üëû"}, {w:"KACAMATA", i:"üëì"},
            {w:"JAM", i:"‚åö"}, {w:"TAS", i:"üéí"}, {w:"PAYUNG", i:"‚òÇÔ∏è"}, {w:"KUNCI", i:"üîë"}, {w:"GUNTING", i:"‚úÇÔ∏è"},
            {w:"GITAR", i:"üé∏"}, {w:"DRUM", i:"ü•Å"}, {w:"BOLA BASKET", i:"üèÄ"}, {w:"SEPEDA", i:"üö≤"}, {w:"PESAWAT", i:"‚úàÔ∏è"},
            {w:"KERETA", i:"üöÇ"}, {w:"PERAHU", i:"‚õµ"}, {w:"ROKET", i:"üöÄ"}, {w:"ROBOT", i:"ü§ñ"}, {w:"BONEKA", i:"üß∏"}
        ];

        // BANK SUKU KATA DIPERBARUI (Fokus 4 Huruf, Ejaan Diperbaiki)
        const syllableBank = {
            'B': [
                ['BA-JU','üëï'], ['BO-LA','‚öΩ'], ['BU-KU','üìö'], ['BI-RU','üîµ'], ['BA-TU','ü™®'], 
                ['BA-CA','üìñ'], ['BA-WA','üõçÔ∏è'], ['BO-LU','üç∞'], ['BI-BI','üë©'], ['BA-YI','üë∂'],
                ['BA-HU','üí™'], ['BA-TA','üß±'], ['BU-SA','üßº'], ['BI-JI','üå±'], ['BU-TA','üôà'],
                ['BE-DA','‚ÜîÔ∏è'], ['BO-BI','üë¶'], ['BA-KI','üçΩÔ∏è'], ['BA-LI','üèñÔ∏è'], ['BA-RU','üÜï']
            ],
            'C': [
                ['CA-BE','üå∂Ô∏è'], ['CU-CI','üßº'], ['CE-RI','üçí'], ['CA-RA','üõ£Ô∏è'], ['CU-KA','üß™'],
                ['CI-NA','üá®üá≥'], ['CU-MA','1Ô∏è‚É£'], ['CA-RI','üîç'], ['CI-TA','üí≠'], ['CI-UM','üíã'],
                ['CU-TI','üèñÔ∏è'], ['CA-KU','ü¶æ'], ['CO-BA','üîÑ'], ['CA-AT','üé®'], ['CI-RI','üè∑Ô∏è'],
                ['CU-MI','ü¶ë'], ['CI-KA','üëß'], ['CI-CAK','ü¶é'], ['CA-KAR','üêæ'], ['CE-PAT','‚ö°']
            ],
            'D': [
                ['DA-DU','üé≤'], ['DU-A','2Ô∏è‚É£'], ['DO-NAT','üç©'], ['DA-UN','üçÉ'], ['DU-RI','üåµ'],
                ['DE-SA','üè°'], ['DA-GU','üßî'], ['DA-HI','ü§ï'], ['DA-NA','üí∞'], ['DA-SI','üëî'],
                ['DO-I','üë´'], ['DU-KU','üçá'], ['DE-BU','üí®'], ['DI-RI','üë§'], ['DA-YA','üîã'],
                ['DO-A','üôè'], ['DO-SA','‚ùå'], ['DU-NIA','üåç'], ['DI-A','üëâ'], ['DA-RA','üïäÔ∏è']
            ],
            'F': [
                ['FO-TO','üì∑'], ['FE-RI','üö¢'], ['FA-JAR','üåÖ'], ['FO-KUS','üéØ'], ['FI-SIK','üí™'],
                ['FA-SE','üìà'], ['FU-JI','üóª'], ['FA-KIR','ü§≤'], ['FE-TA','üßÄ'], ['FI-NI','üèÅ'],
                ['FA-HAM','üí°'], ['FO-YER','üè†'], ['FA-UNA','üêæ'], ['FLO-RA','üå∫'], ['FRE-ON','‚ùÑÔ∏è']
            ],
            'G': [
                ['GI-GI','ü¶∑'], ['GU-LA','üç¨'], ['GU-RU','üë©‚Äçüè´'], ['GA-UN','üëó'], ['GU-CI','üè∫'],
                ['GA-YA','üòé'], ['GE-MA','üîä'], ['GO-A','üï≥Ô∏è'], ['GU-SI','üëÑ'], ['GA-JI','üíµ'],
                ['GI-ZI','ü•ó'], ['GA-RA','üßÇ'], ['GU-NA','üõ†Ô∏è'], ['GO-JEK','üõµ'], ['GE-RA','üö∂'],
                ['GA-JAH','üêò'], ['GA-LAK','üò°'], ['GO-SOK','üßΩ'], ['GU-BUK','üõñ'], ['GE-RAS','üöø']
            ],
            'H': [
                ['HA-TI','‚ù§Ô∏è'], ['HA-RI','‚òÄÔ∏è'], ['HA-WA','üå¨Ô∏è'], ['HU-LU','üèûÔ∏è'], ['HI-NA','üëé'],
                ['HO-BI','üé®'], ['HA-LO','üìû'], ['HU-NI','üè†'], ['HI-U','ü¶à'], ['HA-JI','üïã'],
                ['HU-TAN','üå≥'], ['HI-TAM','‚ö´'], ['HI-JAU','üü¢'], ['HU-JAN','üåßÔ∏è'], ['HA-BIS','üîö'],
                ['HA-PUS','‚úèÔ∏è'], ['HE-WAN','üêæ'], ['HA-US','ü•§'], ['HA-DIR','üôã'], ['HA-RIMAU','üêØ']
            ],
            'J': [
                ['JA-RI','üñêÔ∏è'], ['JA-HE','üç†'], ['JA-LA','üï∏Ô∏è'], ['JI-WA','üëª'], ['JU-GA','‚ûï'],
                ['JU-TA','üí∞'], ['JA-MU','üåø'], ['JA-WA','üó∫Ô∏è'], ['JU-LI','üìÖ'], ['JU-NI','üìÖ'],
                ['JA-LAN','üõ£Ô∏è'], ['JAM-BU','üçà'], ['JUS','ü•§'], ['JE-RUK','üçä'], ['JA-GUNG','üåΩ'],
                ['JA-RUM','ü™°'], ['JA-UH','üî≠'], ['JE-LAS','üëì'], ['JA-UH','üõ§Ô∏è'], ['JE-RA-PAH','ü¶í']
            ],
            'K': [
                ['KA-KI','ü¶∂'], ['KU-DA','üêé'], ['KO-PI','‚òï'], ['KA-CA','ü™û'], ['KE-JU','üßÄ'],
                ['KU-KU','üíÖ'], ['KA-YA','üí∞'], ['KO-KO','üë¶'], ['KI-NI','üëá'], ['KA-MU','üëâ'],
                ['KI-TA','üë•'], ['KO-TA','üèôÔ∏è'], ['KA-TA','üó£Ô∏è'], ['KU-PU','ü¶ã'], ['KA-YU','ü™µ'],
                ['KO-LAM','üèä'], ['KA-PAL','üö¢'], ['KA-SUR','üõèÔ∏è'], ['KA-MIS','üìÖ'], ['KE-LAS','üè´']
            ],
            'L': [
                ['LA-RI','üèÉ'], ['LI-MA','5Ô∏è‚É£'], ['LA-BU','üéÉ'], ['LU-KA','ü©π'], ['LA-UT','üåä'],
                ['LU-PA','‚ùì'], ['LA-GI','üîÅ'], ['LA-MA','‚è≥'], ['LI-DI','üßπ'], ['LE-LE','üêü'],
                ['LO-BI','üè®'], ['LU-LU','üéì'], ['LAM-PU','üí°'], ['LE-HER','ü¶í'], ['LI-BUR','üèñÔ∏è'],
                ['LU-RUS','üìè'], ['LA-PAR','üçΩÔ∏è'], ['LI-HAT','üëÄ'], ['LE-BAT','üå≥'], ['LE-MAH','ü•Ä']
            ],
            'M': [
                ['MA-TA','üëÄ'], ['ME-JA','ü™ë'], ['MA-DU','üçØ'], ['MA-MA','üë©'], ['MA-LU','üôà'],
                ['MU-KA','üòä'], ['MU-DA','üë∂'], ['MA-KAN','üçΩÔ∏è'], ['MA-LAM','üåô'], ['MA-WAR','üåπ'],
                ['MA-LAS','üò¥'], ['MU-LUT','üëÑ'], ['MA-SUK','üö™'], ['MI-NUM','ü•§'], ['ME-RAH','üî¥'],
                ['MA-NIS','üç¨'], ['MO-BIL','üöó'], ['MU-RAH','üè∑Ô∏è'], ['MA-SAK','üç≥'], ['MU-SIM','üå§Ô∏è']
            ],
            'N': [
                ['NA-SI','üçö'], ['NA-MA','üìõ'], ['NI-LA','üü£'], ['NA-DI','‚ù§Ô∏è'], ['NA-GA','üêâ'],
                ['NO-TA','üßæ'], ['NA-IK','üìà'], ['NO-NA','üë©'], ['NI-LAI','üíØ'], ['NA-FAS','üå¨Ô∏è'],
                ['NA-KAL','üòà'], ['NE-NEK','üëµ'], ['NYA-MUK','ü¶ü'], ['NO-MOR','üî¢'], ['NA-NAS','üçç'],
                ['NA-TAL','üéÑ'], ['NI-PIS','üìè'], ['NYA-NYI','üé§'], ['NYA-LA','üî•'], ['NYA-TA','üëì']
            ],
            'P': [
                ['PA-LU','üî®'], ['PI-PI','üòä'], ['PA-KU','üî©'], ['PA-GI','‚òÄÔ∏è'], ['PA-PA','üë®'],
                ['PI-TA','üéÄ'], ['PO-LA','üí†'], ['PU-JI','üôè'], ['PA-RU','ü´Å'], ['PA-SAR','üè™'],
                ['PA-GAR','üöß'], ['PA-HIT','üíä'], ['PA-NAS','ü•µ'], ['PU-TIH','‚ö™'], ['PI-NTU','üö™'],
                ['PO-HON','üå≥'], ['PI-SANG','üçå'], ['PA-SIR','üèñÔ∏è'], ['PA-YUNG','‚òÇÔ∏è'], ['PE-DAS','üå∂Ô∏è']
            ],
            'Q': [
                ['QA-RI','üë≥'], ['QU-RAN','üìñ'], ['QA-SAR','üïå'], ['QI-SAS','‚öñÔ∏è']
            ],
            'R': [
                ['RO-TI','üçû'], ['RO-DA','üé°'], ['RA-JA','üëë'], ['RA-TU','üë∏'], ['RA-GU','ü§î'],
                ['RA-YA','üéâ'], ['RI-BU','üíµ'], ['RA-PI','üëï'], ['RA-K','üóÑÔ∏è'], ['RA-JIN','üìö'],
                ['RU-MAH','üè†'], ['RU-SA','ü¶å'], ['RO-BOT','ü§ñ'], ['RA-MPUT','üíá'], ['RA-ASA','üëÖ'],
                ['RU-WET','üß∂'], ['RU-SAK','üõ†Ô∏è'], ['RA-JUN','üß™'], ['RA-WAT','üè•'], ['RA-MAI','üëØ']
            ],
            'S': [
                ['SA-PI','üêÑ'], ['SU-SU','ü•õ'], ['SA-PU','üßπ'], ['SA-TU','1Ô∏è‚É£'], ['SA-YA','üôã'],
                ['SU-KA','üëç'], ['SO-TO','üç≤'], ['SO-FA','üõãÔ∏è'], ['SI-KU','üí™'], ['SA-TE','üç¢'],
                ['SE-PI','ü§´'], ['SA-KU','üëñ'], ['SA-KIT','ü§í'], ['SE-PATU','üëû'], ['SA-YUR','ü•¨'],
                ['SI-KAT','ü™•'], ['SE-MUT','üêú'], ['SU-RAT','‚úâÔ∏è'], ['SI-ANG','‚òÄÔ∏è'], ['SA-BUN','üßº']
            ],
            'T': [
                ['TO-PI','üß¢'], ['TA-LI','ü™¢'], ['TA-HU','üßä'], ['TI-GA','3Ô∏è‚É£'], ['TI-SU','üßª'],
                ['TO-KO','üè™'], ['TA-MU','üë•'], ['TA-RI','üíÉ'], ['TU-GU','üóº'], ['TU-JU','üéØ'],
                ['TI-PU','üÉè'], ['TAS','üéí'], ['TE-LOR','ü•ö'], ['TI-DUR','üí§'], ['TA-NAM','üå±'],
                ['TE-MAN','üë´'], ['TA-KUT','üò±'], ['TA-HUN','üìÖ'], ['TU-JUH','7Ô∏è‚É£'], ['TI-KUS','üêÅ']
            ],
            'V': [
                ['VI-LA','üè°'], ['VO-LI','üèê'], ['VAS','üè∫'], ['VI-SI','üëÅÔ∏è'], ['VE-TO','üö´'],
                ['VA-KUM','üßπ'], ['VI-RUS','ü¶†'], ['VA-RIA','üé®']
            ],
            'W': [
                ['WA-JAH','üòä'], ['WA-TU','ü™®'], ['WA-NI','ü¶Å'], ['WA-JA','üî©'], ['WA-YANG','üé≠'],
                ['WA-JAN','üç≥'], ['WAR-NA','üé®'], ['WOR-TEL','ü•ï'], ['WA-KIL','üëî'], ['WA-JIB','‚ö†Ô∏è'],
                ['WA-KTU','‚åö'], ['WA-RUNG','üè™'], ['WA-RGA','üë®‚Äçüë©‚Äçüëß']
            ],
            'X': [
                ['X-RAY','ü¶¥'], ['XI-LO-FON','üéπ']
            ],
            'Y': [
                ['YO-YO','ü™Ä'], ['YA-KIN','üëç'], ['YE-NI','üëß'], ['YU-YU','ü¶Ä'], ['YE-S','‚úÖ'],
                ['YA-TIM','üßí'], ['YU-NAN','üåè']
            ],
            'Z': [
                ['ZE-BRA','ü¶ì'], ['ZO-NA','üöß'], ['ZAM-RUD','üíé'], ['ZA-KAT','üí∞'], ['ZA-ITUN','ü´í'],
                ['ZE-RO','0Ô∏è‚É£'], ['ZO-OM','üîç'], ['ZA-MAN','‚è≥']
            ]
        };

        // BANK BACA KATA (Fokus 10 dari Bank ini)
        const readingWords = [
            "BOLA", "MAMA", "PAPA", "BUKU", "SAPI", "KACA", "LARI", "GIGI", "KAKI", 
            "MEJA", "BATU", "JARI", "MATA", "SUSU", "ROTI", "SAYA", "SUKA", "BACA"
        ];

        /* ================= STATE ================= */
        let activeSyllables = [];
        let activeSylIndex = 0;
        
        let activeReading = [];
        let activeReadIndex = 0;

        let gameScore = 0;
        let activeGameQueue = []; // Antrian 10 soal
        let activeGameIndex = 0;
        let activeGameQuestion = null;
        let isGameLocked = false;

        /* ================= NAVIGASI ================= */
        function nav(screenId) {
            document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            window.scrollTo(0,0);

            if(screenId === 'alphabet') renderAlphabet();
            if(screenId === 'syllable-select') renderSyllableSelect();
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text.replace(/-/g, ''));
            u.lang = 'id-ID';
            u.rate = 0.9;
            window.speechSynthesis.speak(u);
        }

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        /* ================= 2. ALFABET ================= */
        function renderAlphabet() {
            const grid = document.getElementById('grid-alphabet');
            grid.innerHTML = '';
            alphabetData.forEach(item => {
                const btn = document.createElement('button');
                btn.className = "btn-3d bg-white border border-yellow-200 rounded-2xl p-6 flex flex-col items-center justify-center hover:bg-yellow-50 min-h-[160px]";
                btn.onclick = () => speak(`${item.char}... ${item.word}`);
                btn.innerHTML = `
                    <span class="text-6xl mb-2">${item.icon}</span>
                    <span class="text-6xl font-black text-yellow-500 font-sans">${item.char}</span>
                    <span class="text-sm font-bold text-gray-400 mt-2 uppercase tracking-widest">${item.word}</span>
                `;
                grid.appendChild(btn);
            });
        }

        /* ================= 3 & 4. SUKU KATA ================= */
        function renderSyllableSelect() {
            const grid = document.getElementById('grid-syllable-letters');
            grid.innerHTML = '';
            Object.keys(syllableBank).sort().forEach(char => {
                const btn = document.createElement('button');
                btn.className = "btn-3d bg-white border-b-4 border-green-200 rounded-2xl p-4 text-4xl font-bold text-green-600 hover:bg-green-50 aspect-square";
                btn.innerText = char;
                btn.onclick = () => startSyllableSession(char);
                grid.appendChild(btn);
            });
        }

        function startSyllableSession(char) {
            const allWords = syllableBank[char];
            const shuffled = shuffle([...allWords]);
            activeSyllables = shuffled.slice(0, 3);
            activeSylIndex = 0;
            nav('syllable-play');
            renderSyllableCard();
        }

        function renderSyllableCard() {
            const current = activeSyllables[activeSylIndex];
            document.getElementById('syl-icon').innerText = current[1];
            
            const textContainer = document.getElementById('syl-text');
            textContainer.innerHTML = '';
            
            // Cek jika kata mengandung pemisah suku kata (-)
            if(current[0].includes('-')) {
                const parts = current[0].split('-');
                parts.forEach(p => {
                    const span = document.createElement('span');
                    span.className = "syllable-part border-green-300";
                    span.innerText = p;
                    textContainer.appendChild(span);
                });
            } else {
                // Untuk kata satu suku kata (TAS, JUS, dll)
                const span = document.createElement('span');
                span.className = "syllable-part border-green-300";
                span.innerText = current[0];
                textContainer.appendChild(span);
            }

            const dots = document.getElementById('syl-dots');
            dots.innerHTML = '';
            activeSyllables.forEach((_, i) => {
                const d = document.createElement('div');
                d.className = `h-3 w-3 rounded-full ${i === activeSylIndex ? 'bg-green-500' : 'bg-green-200'}`;
                dots.appendChild(d);
            });
        }

        function speakSyllable() {
            speak(activeSyllables[activeSylIndex][0]);
        }

        function nextSyllable() {
            if (activeSylIndex < activeSyllables.length - 1) {
                activeSylIndex++;
                renderSyllableCard();
            } else {
                showCongrats("Latihan Suku Kata Selesai!");
            }
        }

        /* ================= 5 & 6. BACA KATA ================= */
        function startReadingMode() {
            activeReading = shuffle([...readingWords]).slice(0, 10); 
            activeReadIndex = 0;
            nav('reading-play');
            renderReadingCard();
        }

        function renderReadingCard() {
            const word = activeReading[activeReadIndex];
            const el = document.getElementById('read-word');
            el.style.opacity = 0;
            el.style.transform = 'scale(0.8)';
            setTimeout(() => {
                el.innerText = word;
                el.style.opacity = 1;
                el.style.transform = 'scale(1)';
            }, 200);

            const dots = document.getElementById('read-dots');
            dots.innerHTML = '';
            activeReading.forEach((_, i) => {
                const d = document.createElement('div');
                d.className = `h-3 w-3 rounded-full ${i <= activeReadIndex ? 'bg-pink-500' : 'bg-pink-200'}`;
                dots.appendChild(d);
            });
        }

        function speakReadWord() {
            speak(activeReading[activeReadIndex]);
        }

        function checkRead() {
            if (activeReadIndex < activeReading.length - 1) {
                activeReadIndex++;
                speak("Bagus!");
                renderReadingCard();
            } else {
                showCongrats("Kamu Jago Membaca!");
            }
        }

        /* ================= 7. MINI GAME (50 BANK, 10 PER SESSION) ================= */
        function startGameMode() {
            gameScore = 0;
            // 1. Acak Bank 50 soal
            const shuffledBank = shuffle([...miniGameBank]);
            // 2. Ambil 10 soal saja untuk sesi ini
            activeGameQueue = shuffledBank.slice(0, 10);
            activeGameIndex = 0;
            
            document.getElementById('game-score').innerText = gameScore;
            nav('game-play');
            renderGameLevel();
        }

        function renderGameLevel() {
            isGameLocked = false;
            
            // Perbarui indikator soal (Contoh: Soal 1/10)
            document.getElementById('game-progress').innerText = activeGameIndex + 1;

            const correctData = activeGameQueue[activeGameIndex];
            activeGameQuestion = correctData;

            // Buat Pengecoh (Distractor) dari sisa bank (tidak termasuk jawaban benar)
            let distractors = miniGameBank
                .filter(d => d.w !== correctData.w)
                .sort(() => 0.5 - Math.random())
                .slice(0, 2);

            let options = shuffle([correctData, ...distractors]);

            document.getElementById('game-question-icon').innerText = correctData.i;
            document.getElementById('game-feedback').innerText = "";
            
            const btnContainer = document.getElementById('game-options');
            btnContainer.innerHTML = '';

            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "btn-3d w-full bg-white border-2 border-purple-100 text-purple-700 font-bold py-4 rounded-2xl text-xl hover:bg-purple-50 transition";
                btn.innerText = opt.w;
                btn.onclick = function() { checkGameAnswer(opt.w, this); };
                btnContainer.appendChild(btn);
            });
        }

        function checkGameAnswer(selectedWord, btnElement) {
            if (isGameLocked) return;

            if (selectedWord === activeGameQuestion.w) {
                // BENAR
                isGameLocked = true;
                gameScore += 10;
                document.getElementById('game-score').innerText = gameScore;
                
                btnElement.classList.remove('bg-white', 'text-purple-700', 'hover:bg-purple-50');
                btnElement.classList.add('bg-green-500', 'text-white', 'border-green-600');
                speak("Benar!");
                
                setTimeout(() => {
                    if (activeGameIndex < 9) { // 0-9 (Total 10 soal)
                        activeGameIndex++;
                        renderGameLevel();
                    } else {
                        showCongrats("Game Selesai! Skor: " + gameScore);
                    }
                }, 1000);
            } else {
                // SALAH
                btnElement.classList.add('bg-red-500', 'text-white', 'shake');
                speak("Coba lagi");
                setTimeout(() => {
                    btnElement.classList.remove('shake', 'bg-red-500', 'text-white');
                    btnElement.classList.add('bg-white', 'text-purple-700');
                }, 500);
            }
        }

        /* ================= UMUM ================= */
        function showCongrats(msg) {
            document.getElementById('congrats-msg').innerText = msg;
            document.getElementById('overlay-congrats').classList.remove('hidden');
            document.getElementById('overlay-congrats').classList.add('flex');
            speak("Luar biasa! Kamu berhasil.");
        }

        function closeCongrats() {
            document.getElementById('overlay-congrats').classList.add('hidden');
            document.getElementById('overlay-congrats').classList.remove('flex');
            nav('home');
        }
    </script>
</body>
</html>

